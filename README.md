# FontPreview（Font Preview Grid）

AviUtl ExEdit2 向けの汎用プラグイン（`.aux2`）です。
フォント一覧を検索・絞り込みし、選択フォントでプレビュー表示したり、拡張編集へオブジェクトを追加（エイリアス貼り付け相当）できます。

## 対応環境

- AviUtl2 + ExEdit2
- Windows 10 以降推奨

## 使い方

プラグインを読み込むと、フォントプレビュー用のウィンドウ（`FontPreviewClient`）が表示されます。

### 1) フォントを探す

- 上部の検索欄: フォント名で絞り込み
- 種類フィルタ: `すべて` / `システム` / `外部`
  - `外部` は、プラグインと同じ場所にある `Fonts` フォルダ（例: `...\Plugin\Fonts\`）のフォントを列挙します

### 2) プレビューする

- 一覧からフォントを選択すると、右下のプレビューにサンプルテキストを描画します
- サンプルテキスト: 画面下の入力欄で変更
- 背景色: `背景色` ボタンで変更

### 3) 拡張編集へ追加する（ボタン）

右上のボタンで、選択フォントを使ったオブジェクトを現在位置へ追加します。

- `＋` : 標準の `テキスト` オブジェクトを追加
- `VF＋` : `Variable Font Text`（本リポジトリの VariableFont プラグイン）オブジェクトを追加

注意:
- `VF＋` を使うには、`VariableFont.auf2`（表示名: `テキスト(VF)` / effect.name: `Variable Font Text`）がインストールされている必要があります。
- どちらも「エイリアスからオブジェクト作成」を使って追加します（レイヤー/フレームは現在の編集位置）。

### 4) 既存オブジェクトへフォントを適用する（ダブルクリック）

フォント一覧をダブルクリックすると、選択中（またはフォーカス中）のオブジェクトに対してフォント指定を更新します。

- `テキスト`（標準テキスト）: `フォント` を更新
- `Variable Font Text`（テキスト(VF)）: `フォント` または `フォントファイル` を更新
  - システムフォント選択時: `フォント` にファミリ名を入れ、`フォントファイル` は空
  - 外部フォント選択時: `フォント` は空、`フォントファイル` にフォントパスを入れます

## よくある困りごと

- `外部` フォントが出ない
  - `FontPreview.aux2` と同じフォルダに `Fonts` フォルダを作成し、`.ttf/.otf/.ttc` を入れてください。
- `VF＋` で追加できない
  - `VariableFont.auf2` が未導入、または effect 名が一致していない可能性があります。

## 開発者向け（ビルド）

- 推奨: Visual Studio 2022（x64, v143）
- `Release|x64` でビルド
- PowerShell から: `build_release.ps1`


